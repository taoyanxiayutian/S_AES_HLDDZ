# Welcome to S-AES !

>信息安全导论作业2：S-AES算法实现；
本次作业由**欢乐斗地组**利用**Java+swing**完成了一个简单的关于S-AES加解密、双重加密、三重加密和CBC的可视化程序。
针对作业要求，成功完成了1-5关。若图片展示有问题，可以直接查看readme.pdf,也可以查看用户指南.pdf查看详细的使用指南。


# 1. OverView
 
> 整个程序的整体框架如下所示，分别有：

 ![main.png](images%2Fmain.png)
**1.普通程序（s_aes）**
- 加密
- 解密

**2.双重加密（2s_aes）**
- 加密
- 解密
- 中间相遇攻击

**3.三重加密（3s_aes）**
- 加密
- 解密

**4.CBC模式**
- 加密
- 解密


# 2. 基本测试和扩展功能
>基本测试：在这里根据**S-AES算法**编写和调试程序实现了输入可以是**16bit**的数据和**16bit**的密钥，
输出是16bit的密文或密文。
> 
>扩展功能：以及实现了对任意2bit以上的**ASCII字符**的加解密。
## 2.1 加密界面
> 在这里可以实现**16bit二进制明文**和**任意2bit以上的ASCII字符**的加密，
但是同时只支持一种形式的加密，否则会报错；对于十六位二进制的密钥，
可以选择**随机生成**或者**手动输入**，但是需要满足16位。具体展示如下：

- 对16bit二进制明文加密

 ![img2.1.png](images%2Fimg2.1.png) 

- 对ASCII字符加密

![ASCII.png](images%2FASCII.png)

- 同时对16bit二进制明文和ASCII字符加密，会报错，提示只支持一种形式的加密

 ![bothE.png](images%2FbothE.png) 

## 2.2 解密界面
> 在这里可以实现**16bit二进制密文**和**任意bit的ASCII字符**的解密，
但是同时只支持一种形式的加密，否则会报错；对于十六位二进制的密钥，
可以选择**随机生成**或者**手动输入**，但是需要满足16位。具体展示如下：
- 对16bit二进制密文解密, 可以发现输入在加密界面输入的密钥和加密出的密文，解密出了正确的明文**1111111111111111**

 ![img2.2.png](images%2Fimg2.2.png)
- 对ASCII字符解密，可以发现输入在加密界面输入的密钥和加密出的密文，解密出了正确的明文**abc**

 ![DASCII.png](images%2FDASCII.png)
- 同时对16bit二进制密文和ASCII字符解密，会报错，提示只支持一种形式的解密

![bothD.png](images%2FbothD.png)




# 3. 交叉验证
- **组内交叉验证** 针对加解密的结果（二进制和ASCII码）进行交叉验证，
发现可以完成逆向验证，如上图所示。
- **组间交叉验证** 我们同其他组（荔枝组（张芷芮，刘俐莹））针对加解密的结果（二进制和ASCII码）进行交叉验证，
  发现依然可以完成逆向验证。

 
# 4. 多重加密
## 4.1 2-AES
>在这里可以实现输入两个十六位二进制的密钥和明密文，实现对16bit二进制明密文的加解密
- 加密

 ![E2-DES.png](images%2FE2-DES.png)

- 解密

 ![D2-DES.png](images%2FD2-DES.png)

## 4.2 中间相遇攻击
>在这里可以输入一对或多对使用相同密钥的明、密文对，使用中间相遇攻击的方法可以找到正确的密钥Key(K1+K2)。
>
 - 输入一对明密文对会出现多对可行的密钥

![attack.png](images%2Fattack.png)

- 输入多对明密文对出现正确的一对密钥

![attack2.png](images%2Fattack2.png)
## 4.2 3-AES
>这里按照32 bits密钥Key(K1+K2)的模式进行三重加密解密，C=E(K1,D(K2,E(K1,P))),
> 输入两个16 bit的密钥和16bit的明密文就能对明密文加解密。

- 加密

 ![E3S-AES.png](images%2FE3S-AES.png)

- 解密

 ![D3-AES.png](images%2FD3-AES.png)




# 5. 工作模式
>基于S-AES算法，使用密码分组链(CBC)模式对较长的明文消息进行加密。
>输入16位的明密文和初始向量(16 bits) 和密钥对明密文加解密。
- 加密

 ![ECBC.png](images%2FECBC.png)

- 解密

 ![DCBC.png](images%2FDCBC.png)

>这里在CBC模式下进行加密，并尝试对密文分组进行修改，然后进行解密。
可以看到修改密文之前解密得到的结果是Hello,S-AES!
> 在对密文分组进行篡改最后一个字符之后进行解密得到的结果是Hello,S-AEC( 。

>发现篡改密文后会引起最后一个块的更改，用篡改后的密文进行解密会影响解密结果的正确性。
 

![CBC2.png](images%2FCBC2.png)

# 6. 具体实现
- functionalClass文件夹 存放用于实现中间相遇攻击和二进制/ASCII码加解密的函数式算法，便于在ui界面中直接调用。同时还有用于测试CBC模式篡改验证的程序。
- UI文件夹 用于实现程序的ui界面和相关监听器的编写。
- images文件夹 存储了相关关卡测试的图片。
- 如果想要运行程序，可以直接点击src/UI/Main.java程序运行。
